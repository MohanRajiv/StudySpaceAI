{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///Users/admin/Downloads/study-space-ai/client/study-space/app/api/google-drive/auth/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { auth } from \"@clerk/nextjs/server\";\nimport { google } from \"googleapis\";\n\nexport async function GET(req) {\n  try {\n    const { userId } = await auth();\n    if (!userId) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    // Validate environment variables\n    const clientId = process.env.GOOGLE_CLIENT_ID;\n    const clientSecret = process.env.GOOGLE_CLIENT_SECRET;\n    const redirectUri = process.env.GOOGLE_REDIRECT_URI;\n\n    if (!clientId || !clientSecret || !redirectUri) {\n      console.error(\"Missing Google OAuth environment variables:\", {\n        hasClientId: !!clientId,\n        hasClientSecret: !!clientSecret,\n        hasRedirectUri: !!redirectUri,\n      });\n      return NextResponse.json(\n        { \n          error: \"Google Drive integration not configured. Please set GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET, and GOOGLE_REDIRECT_URI environment variables.\" \n        },\n        { status: 500 }\n      );\n    }\n\n    // Initialize OAuth2Client with validated environment variables\n    const oauth2Client = new google.auth.OAuth2(\n      clientId,\n      clientSecret,\n      redirectUri\n    );\n\n    const scopes = [\n      \"https://www.googleapis.com/auth/drive.readonly\",\n    ];\n\n    const authUrl = oauth2Client.generateAuthUrl({\n      access_type: \"offline\",\n      scope: scopes,\n      prompt: \"consent\",\n      state: userId, // Pass userId in state for verification\n    });\n\n    return NextResponse.json({ authUrl });\n  } catch (error) {\n    console.error(\"Error generating auth URL:\", error);\n    return NextResponse.json(\n      { error: `Failed to generate auth URL: ${error.message}` },\n      { status: 500 }\n    );\n  }\n}\n\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,GAAG;IAC3B,IAAI;QACF,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAA,6LAAI;QAC7B,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,iCAAiC;QACjC,MAAM,WAAW,QAAQ,GAAG,CAAC,gBAAgB;QAC7C,MAAM,eAAe,QAAQ,GAAG,CAAC,oBAAoB;QACrD,MAAM,cAAc,QAAQ,GAAG,CAAC,mBAAmB;QAEnD,IAAI,CAAC,YAAY,CAAC,gBAAgB,CAAC,aAAa;YAC9C,QAAQ,KAAK,CAAC,+CAA+C;gBAC3D,aAAa,CAAC,CAAC;gBACf,iBAAiB,CAAC,CAAC;gBACnB,gBAAgB,CAAC,CAAC;YACpB;YACA,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,OAAO;YACT,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,+DAA+D;QAC/D,MAAM,eAAe,IAAI,+JAAM,CAAC,IAAI,CAAC,MAAM,CACzC,UACA,cACA;QAGF,MAAM,SAAS;YACb;SACD;QAED,MAAM,UAAU,aAAa,eAAe,CAAC;YAC3C,aAAa;YACb,OAAO;YACP,QAAQ;YACR,OAAO;QACT;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAQ;IACrC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,CAAC,6BAA6B,EAAE,MAAM,OAAO,EAAE;QAAC,GACzD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}